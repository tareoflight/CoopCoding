syntax = "proto3";
package node;

/***************************************
 **                                   **
 **              Request              **
 **                                   **
 ***************************************/

message Request {
    oneof request_type {
        ControlRequest control_request = 1;
        MapRequest map_request = 2;
        MatRequest mat_request = 3;
    }
}

message MapRequest {
    PBVector3 player = 1;
}

message MatRequest {
    uint32 id = 1;
}

message ControlRequest {
    oneof control_type {
        Shutdown shutdown = 1;
    }
}

message Shutdown {
    uint32 delay = 1;
}

/***************************************
 **                                   **
 **             NodeEvent             **
 **                                   **
 ***************************************/

message NodeEvent {
    oneof event_type {
        Heartbeat heartbeat_event = 1;
        MapEvent map_event = 2;
        MatData mat_data = 3;
    }
}

message MapEvent {
    repeated PBChunkData chunks = 1;
    repeated PBNodeData nodes = 2;
}

message Heartbeat{
    uint32 status = 1;
}

/***************************************
 **                                   **
 **                Util               **
 **                                   **
 ***************************************/

message PBChunkData {
    uint64 id = 1;
    PBVector3 location = 2;
}

message PBNodeData {
    uint64 id = 1;
    uint32 chunk_id = 2;
    PBVector3 location = 3;
    bytes contents = 4;
}

message MatData {
    uint32 id = 1;
    string name = 2;
    string description = 3;
}

message PBVector3 {
    float x = 1;
    float y = 2;
    float z = 3;
}